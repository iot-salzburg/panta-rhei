-- Generated by Oracle SQL Developer Data Modeler 19.2.0.182.1216
--   at:        2019-08-12 15:09:05 CEST
--   site:      Oracle Database 11g
--   type:      Oracle Database 11g


CREATE TABLE client (
    name                 VARCHAR2(25) NOT NULL,
    keyfile              BLOB,
    datetime             DATE,
    creator_id           CHAR(12) NOT NULL,
    system_system_uid    CHAR(8) NOT NULL,
    system_company_uid   CHAR(8) NOT NULL
);

ALTER TABLE client ADD CONSTRAINT client_pk PRIMARY KEY ( name );

CREATE TABLE company (
    "uid"        CHAR(8) NOT NULL,
    domain       VARCHAR2(4) NOT NULL,
    enterprise   VARCHAR2(15) NOT NULL
);

ALTER TABLE company ADD CONSTRAINT company_pk PRIMARY KEY ( "uid" );

CREATE TABLE gost_ds (
    link          URITYPE,
    client_name   VARCHAR2(25) NOT NULL
);

CREATE TABLE gost_thing (
    link                 URITYPE,
    system_system_uid    CHAR(8) NOT NULL,
    system_company_uid   CHAR(8) NOT NULL
);

CREATE TABLE is_admin_of (
    user_uid      CHAR(12) NOT NULL,
    company_uid   CHAR(8) NOT NULL,
    creator_uid   CHAR(12) NOT NULL,
    datetime      DATE
);

ALTER TABLE is_admin_of ADD CONSTRAINT is_admin_of_pk PRIMARY KEY ( user_uid );

CREATE TABLE is_agent_of (
    user_id              CHAR(12) NOT NULL,
    system_company_uid   CHAR(8) NOT NULL,
    system_system_uid    CHAR(8) NOT NULL,
    creator_id           CHAR(12) NOT NULL,
    datetime             DATE
);

ALTER TABLE is_agent_of ADD CONSTRAINT is_agent_of_pk PRIMARY KEY ( user_id );

CREATE TABLE system (
    system_uid           CHAR(8) NOT NULL,
    company_uid          CHAR(8) NOT NULL,
    workcenter           VARCHAR2(30) NOT NULL,
    station              VARCHAR2(20) NOT NULL,
    company_domain       VARCHAR2(4) NOT NULL,
    company_enterprise   VARCHAR2(20) NOT NULL
);

ALTER TABLE system ADD CONSTRAINT system_pk PRIMARY KEY ( system_uid,
                                                          company_uid );

CREATE TABLE "user" (
    "uid"        CHAR(12) NOT NULL,
    first_name   VARCHAR2(25) NOT NULL,
    sur_name     VARCHAR2(25) NOT NULL,
    birthdate    DATE,
    email        VARCHAR2(35) NOT NULL,
    password     VARCHAR2(20) NOT NULL
);

ALTER TABLE "user" ADD CONSTRAINT user_pk PRIMARY KEY ( "uid" );

ALTER TABLE is_admin_of
    ADD CONSTRAINT admin_user_fk FOREIGN KEY ( user_uid )
        REFERENCES "user" ( "uid" );

ALTER TABLE is_agent_of
    ADD CONSTRAINT agent_user_fk FOREIGN KEY ( user_id )
        REFERENCES "user" ( "uid" );

ALTER TABLE client
    ADD CONSTRAINT client_system_fk FOREIGN KEY ( system_system_uid,
                                                  system_company_uid )
        REFERENCES system ( system_uid,
                            company_uid );

ALTER TABLE is_agent_of
    ADD CONSTRAINT creator_agent_fk FOREIGN KEY ( creator_id )
        REFERENCES "user" ( "uid" );

ALTER TABLE client
    ADD CONSTRAINT creator_fk FOREIGN KEY ( creator_id )
        REFERENCES "user" ( "uid" );

ALTER TABLE is_admin_of
    ADD CONSTRAINT creator_user_fk FOREIGN KEY ( creator_uid )
        REFERENCES "user" ( "uid" );

ALTER TABLE gost_ds
    ADD CONSTRAINT gost_ds_client_fk FOREIGN KEY ( client_name )
        REFERENCES client ( name );

ALTER TABLE gost_thing
    ADD CONSTRAINT gost_thing_system_fk FOREIGN KEY ( system_system_uid,
                                                      system_company_uid )
        REFERENCES system ( system_uid,
                            company_uid );

ALTER TABLE is_admin_of
    ADD CONSTRAINT is_admin_of_company_fk FOREIGN KEY ( company_uid )
        REFERENCES company ( "uid" );

ALTER TABLE is_agent_of
    ADD CONSTRAINT is_agent_of_system_fk FOREIGN KEY ( system_system_uid,
                                                       system_company_uid )
        REFERENCES system ( system_uid,
                            company_uid );

ALTER TABLE system
    ADD CONSTRAINT system_company_fk FOREIGN KEY ( company_uid )
        REFERENCES company ( "uid" );



-- Oracle SQL Developer Data Modeler Summary Report:
--
-- CREATE TABLE                             8
-- CREATE INDEX                             0
-- ALTER TABLE                             17
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE MATERIALIZED VIEW LOG             0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
--
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
--
-- REDACTION POLICY                         0
--
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
--
-- ERRORS                                   0
-- WARNINGS                                 0
